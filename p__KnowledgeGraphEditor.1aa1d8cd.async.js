(self.webpackChunkrapex_studio=self.webpackChunkrapex_studio||[]).push([[106],{4023:function(Pe,H,a){"use strict";a.r(H),a.d(H,{default:function(){return Ce}});var Z=a(67294),i=a(13062),u=a(71230),x=a(18106),y=a(63885),fe=a(89032),q=a(15746),ye=a(13254),R=a(14277),b=a(2824),ee=a(57663),te=a(71577),re=a(77883),ve=a(49747),ne=a(47673),L=a(4107),ae=a(43358),k=a(34041),Y=a(11849),se=a(39428),z=a(3182),Ze=a(34792),F=a(48086),Ne=a(9715),d=a(55843),ue=a(17566),D=a(67569);function ce(_,m,K){console.log("makeQueryStr filter: ",K);var G=":select [:*]",c="",P="";if(m){var E=Object.keys(m)[0],I=Object.values(m)[0];E&&I&&(I==="ascend"?c=":order-by [:".concat(E,"]"):c=":order-by [[:".concat(E," :desc]]"))}if(_){for(var T=[],g=0,S=Object.keys(_);g<S.length;g++){var w=S[g];["current","pageSize"].indexOf(w)<0&&_[w].length>0&&T.push("[:like [:upper :".concat(w,'] [:upper "%').concat(_[w],'%"]]'))}T.length==1?P=":where ".concat(T[0]):T.length>1&&(P=":where [:or ".concat(T.join(" "),"]"))}return"{".concat(G," ").concat(c," ").concat(P,"}")}var e=a(85893),M,B=function(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"Notice:"}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"1. Select the source node type and target node type."}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"2. Select the source node and target node."}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"3. Select the relationship type."}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"4. Input the key sentence."})]})},de=function(m){var K=d.Z.useForm(),G=(0,b.Z)(K,1),c=G[0],P=d.Z.useWatch("source_type",c),E=d.Z.useWatch("target_type",c),I=(0,Z.useState)([]),T=(0,b.Z)(I,2),g=T[0],S=T[1],w=(0,Z.useState)(!1),v=(0,b.Z)(w,2),j=v[0],Q=v[1],oe=(0,Z.useState)("Search nodes ..."),$=(0,b.Z)(oe,2),le=$[0],C=$[1],N=(0,Z.useState)(void 0),we=(0,b.Z)(N,2),ie=we[0],he=we[1];(0,Z.useEffect)(function(){(0,D.zX)().then(function(f){console.log("Get types of nodes: ",f);var l=[];f.node_types?(f.node_types.forEach(function(p){l.push({order:0,label:p,value:p})}),S(l)):S([])}).catch(function(f){console.log("requestNodes Error: ",f),F.ZP.error("Get types of nodes error, please refresh the page"),S([])})},[]);var Oe=function(){var f=(0,z.Z)((0,se.Z)().mark(function l(p,O,W){var X;return(0,se.Z)().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:M&&(clearTimeout(M),M=null),X=function(){Q(!0),(0,D.g7)({query_str:ce({id:O,name:O},{},{}),label_type:p}).then(function(ge){var Ke=ge.data,_e=Ke.map(function(A){return{value:"".concat(A.id),text:"".concat(A.id," | ").concat(A.name)}});console.log("getLabels results: ",_e);var Re=_e.map(function(A){return{label:A.text,value:A.value}});Q(!1),W(Re)}).catch(function(ge){console.log("requestNodes Error: ",ge),W([]),Q(!1)})},M=setTimeout(X,300);case 3:case"end":return me.stop()}},l)}));return function(p,O,W){return f.apply(this,arguments)}}(),je=function(l){he(void 0),C("Search ".concat(l," nodes ..."))},be=function(l,p){p?Oe(l,p,he):he(void 0)},Te=function(l,p,O){console.log("handleSelectNode: ",p,O);var W=p,X=O.label.replace("".concat(W," | "),"");console.log("handleSelectNodeType: ",l,p,O),l=="source"?(c.setFieldsValue({source_id:W}),c.setFieldsValue({source_name:X})):l=="target"&&(c.setFieldsValue({target_id:W}),c.setFieldsValue({target_name:X}))},De=function(){c.validateFields().then(function(l){if(console.log("onConfirm form values: ",l),m.onSubmit){var p=(0,Y.Z)({},l);m.onSubmit(p).then(function(){c.resetFields()}).catch(function(O){console.log("onConfirm error: ",O),F.ZP.error("Submit error, please try later!")})}}).catch(function(l){F.ZP.error("Unknow error, please try later!"),console.log("errorInfo: ",l)})};return(0,e.jsxs)(u.Z,{className:"graph-form-container",children:[(0,e.jsx)("h3",{className:"title",children:"Graph Form"}),(0,e.jsx)("p",{className:"graph-help",children:B()}),(0,e.jsxs)(d.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},form:c,className:"graph-form",initialValues:{remember:!0},autoComplete:"off",labelAlign:"left",children:[(0,e.jsx)(d.Z.Item,{label:"Source Node Type",name:"source_type",rules:[{required:!0,message:"Please select a node type."}],children:(0,e.jsx)(k.Z,{allowClear:!0,defaultActiveFirstOption:!1,showArrow:!0,placeholder:"Please select a node type.",options:g,filterOption:!0,onSelect:je})}),(0,e.jsx)(d.Z.Item,{label:"Source Node ID",name:"source_id",rules:[{required:!0,message:"Please enter your expected node."}],children:(0,e.jsx)(k.Z,{showSearch:!0,allowClear:!0,loading:j,defaultActiveFirstOption:!1,showArrow:!0,placeholder:le,onSearch:function(l){return be(P,l)},options:ie,filterOption:!1,onSelect:function(l,p){return Te("source",l,p)},notFoundContent:(0,e.jsx)(R.Z,{description:j?"Searching...":ie!==void 0?"Not Found":"Enter your interested ".concat(P," ...")})})}),(0,e.jsx)(d.Z.Item,{label:"Source Node Name",name:"source_name",hidden:!0,rules:[{required:!0,message:"Please enter your expected node."}],children:(0,e.jsx)(L.Z,{placeholder:"Please enter the source node name",disabled:!0})}),(0,e.jsx)(d.Z.Item,{label:"Target Node Type",name:"target_type",rules:[{required:!0,message:"Please select a node type."}],children:(0,e.jsx)(k.Z,{allowClear:!0,defaultActiveFirstOption:!1,showArrow:!0,placeholder:"Please select a node type.",options:g,filterOption:!0,onSelect:je})}),(0,e.jsx)(d.Z.Item,{label:"Target Node ID",name:"target_id",rules:[{required:!0,message:"Please enter your expected node."}],children:(0,e.jsx)(k.Z,{showSearch:!0,allowClear:!0,loading:j,defaultActiveFirstOption:!1,showArrow:!0,placeholder:le,onSearch:function(l){return be(E,l)},options:ie,filterOption:!1,onSelect:function(l,p){return Te("target",l,p)},notFoundContent:(0,e.jsx)(R.Z,{description:j?"Searching...":ie!==void 0?"Not Found":"Enter your interested ".concat(E," ...")})})}),(0,e.jsx)(d.Z.Item,{label:"Target Node Name",name:"target_name",hidden:!0,rules:[{required:!0,message:"Please enter your expected node."}],children:(0,e.jsx)(L.Z,{placeholder:"Please enter the target node name",disabled:!0})}),(0,e.jsx)(d.Z.Item,{label:"Relation Type",name:"relation_type",rules:[{required:!0,message:"Please enter relationship type."}],children:(0,e.jsx)(L.Z,{placeholder:"Please enter the target node name"})}),(0,e.jsx)(d.Z.Item,{label:"PMID",name:"pmid",rules:[{required:!0,message:"Please enter pmid which is related with your curated knowledge."}],children:(0,e.jsx)(ve.Z,{placeholder:"Please enter the pmid",min:1,max:1e8,style:{width:"100%"}})}),(0,e.jsx)(d.Z.Item,{label:"Key Sentence",name:"key_sentence",rules:[{required:!0,message:"Please input key sentence!"}],children:(0,e.jsx)(ue.Z,{rows:8,placeholder:"Please input key sentence!"})}),(0,e.jsxs)(d.Z.Item,{wrapperCol:{offset:15},children:[(0,e.jsx)(te.Z,{style:{marginRight:"10px"},onClick:m.onClose,children:"Cancel"}),(0,e.jsx)(te.Z,{type:"primary",onClick:De,children:"Submit"})]})]})]})},V=de,xe=a(66456),U=a(15885),Se=a(71153),J=a(60331),r=[{title:"Relation Type",key:"relation_type",align:"center",dataIndex:"relation_type",fixed:"left",width:150},{title:"PMID",dataIndex:"pmid",align:"center",key:"pmid",render:function(m){return(0,e.jsx)("a",{target:"_blank",href:"https://pubmed.ncbi.nlm.nih.gov/?term=".concat(m),children:m})},fixed:"left",width:100},{title:"Source Name",dataIndex:"source_name",key:"source_name",align:"center",width:200},{title:"Source ID",dataIndex:"source_id",align:"center",key:"source_id",width:150},{title:"Source Type",dataIndex:"source_type",align:"center",key:"source_type",width:100},{title:"Target Name",dataIndex:"target_name",align:"center",key:"target_name",width:200},{title:"Target ID",dataIndex:"target_id",align:"center",key:"target_id",width:150},{title:"Target Type",dataIndex:"target_type",align:"center",key:"target_type",width:100},{title:"Created Time",key:"created_at",align:"center",dataIndex:"created_at",render:function(m){return new Date(m).toLocaleString()},width:200}],n=[{source_name:"John Brown",source_id:"32",source_type:"New York No. 1 Lake Park",target_name:"John Brown",target_id:"32",target_type:"New York No. 1 Lake Park",relation_type:"relation_type",key_sentence:"key_sentence",pmid:123456}],o=function(m){var K=(0,Z.useState)({}),G=(0,b.Z)(K,2),c=G[0],P=G[1],E=(0,Z.useState)(!1),I=(0,b.Z)(E,2),T=I[0],g=I[1],S=(0,Z.useState)(1),w=(0,b.Z)(S,2),v=w[0],j=w[1],Q=(0,Z.useState)(30),oe=(0,b.Z)(Q,2),$=oe[0],le=oe[1];return(0,Z.useEffect)(function(){g(!0),m.getTableData(v,$).then(function(C){P(C),g(!1)}).catch(function(C){console.log("Get knowledges error: ",C),P({}),g(!1)})},[v,$]),(0,e.jsx)(u.Z,{className:"graph-table-container",children:(0,e.jsx)(U.Z,{size:"small",className:"graph-table",columns:r,loading:T,scroll:{x:1e3,y:620},dataSource:c.data,rowKey:function(N){return"".concat(N.source_id,"-").concat(N.target_id)},expandable:{expandedRowRender:function(N){return(0,e.jsxs)("p",{style:{margin:0},children:[(0,e.jsx)(J.Z,{children:"Key Sentence"})," ",N.key_sentence||"No Key Sentence"]})}},pagination:{showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["10","20","50","100"],current:v,pageSize:$,total:c.total||0,position:["bottomRight"],showTotal:function(N){return"Total ".concat(N," items")}},onChange:function(N){j(N.current||1),le(N.pageSize||10)}})})},s=o,t=a(92570),pe=a(43926),h=8,Ge=function(){var m=Z.useState(0),K=(0,b.Z)(m,2),G=K[0],c=K[1],P=function(g){return console.log("Submit knowledge: ",g),new Promise(function(S,w){(0,D.$7)(g).then(function(v){console.log("Post knowledge: ",v),c(G+1),S(v)}).catch(function(v){console.log("Post knowledge error: ",v),c(G+1),w(v)})})},E=function(g,S){return new Promise(function(w,v){(0,D.ix)({page:g,page_size:S}).then(function(j){console.log("Get knowledges: ",j),w({data:j.data,total:j.total,page:g,pageSize:S})}).catch(function(j){console.log("Get knowledges error: ",j),v(j)})})},I=[{key:"table-viewer",label:(0,e.jsxs)("span",{children:[(0,e.jsx)(t.Z,{}),"Table Viewer"]}),children:(0,e.jsx)(s,{getTableData:E},G)},{key:"graph-viewer",label:(0,e.jsxs)("span",{children:[(0,e.jsx)(pe.Z,{}),"Graph Viewer"]}),children:(0,e.jsx)(R.Z,{}),disabled:!0}];return(0,e.jsxs)(u.Z,{gutter:8,className:"knowledge-graph-editor",children:[(0,e.jsx)(q.Z,{xxl:h,xl:h,lg:h,md:24,sm:24,xs:24,className:"form",children:(0,e.jsx)(V,{onSubmit:P})}),(0,e.jsxs)(q.Z,{xxl:24-h,xl:24-h,lg:24-h,md:24,sm:24,xs:24,className:"table",children:[(0,e.jsx)("h3",{className:"title",children:"History Table"}),(0,e.jsx)(y.Z,{size:"small",defaultActiveKey:"table-viewer",items:I})]})]})},Ee=Ge,Ie=function(){return(0,e.jsx)(Ee,{})},Ce=Ie},67569:function(Pe,H,a){"use strict";a.d(H,{jN:function(){return ye},Nx:function(){return b},xD:function(){return te},in:function(){return L},ix:function(){return k},$7:function(){return se},g7:function(){return Ze},zX:function(){return ue},zV:function(){return ce},mc:function(){return de},aU:function(){return xe},aC:function(){return Se}});var Z=a(93224),i=a(39428),u=a(11849),x=a(3182),y=a(74310),fe=null,q=["id"];function ye(r,n){return R.apply(this,arguments)}function R(){return R=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/dimension",(0,u.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:n},o||{})));case 1:case"end":return t.stop()}},r)})),R.apply(this,arguments)}function b(r,n){return ee.apply(this,arguments)}function ee(){return ee=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/graphs",(0,u.Z)({method:"GET",params:(0,u.Z)({},n)},o||{})));case 1:case"end":return t.stop()}},r)})),ee.apply(this,arguments)}function te(r,n){return re.apply(this,arguments)}function re(){return re=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/graphs",(0,u.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:n},o||{})));case 1:case"end":return t.stop()}},r)})),re.apply(this,arguments)}function ve(r,n){return ne.apply(this,arguments)}function ne(){return ne=_asyncToGenerator(_regeneratorRuntime().mark(function r(n,o){var s,t;return _regeneratorRuntime().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return s=n.id,t=_objectWithoutProperties(n,fe),h.abrupt("return",request("/api/v1/graphs/".concat(s),_objectSpread({method:"GET",params:_objectSpread({},t)},o||{})));case 2:case"end":return h.stop()}},r)})),ne.apply(this,arguments)}function L(r,n){return ae.apply(this,arguments)}function ae(){return ae=(0,x.Z)((0,i.Z)().mark(function r(n,o){var s,t;return(0,i.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return s=n.id,t=(0,Z.Z)(n,q),h.abrupt("return",(0,y.WY)("/api/v1/graphs/".concat(s),(0,u.Z)({method:"DELETE",params:(0,u.Z)({},t)},o||{})));case 2:case"end":return h.stop()}},r)})),ae.apply(this,arguments)}function k(r,n){return Y.apply(this,arguments)}function Y(){return Y=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/knowledges",(0,u.Z)({method:"GET",params:(0,u.Z)({},n)},o||{})));case 1:case"end":return t.stop()}},r)})),Y.apply(this,arguments)}function se(r,n){return z.apply(this,arguments)}function z(){return z=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/knowledges",(0,u.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:n},o||{})));case 1:case"end":return t.stop()}},r)})),z.apply(this,arguments)}function Ze(r,n){return F.apply(this,arguments)}function F(){return F=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/labels",(0,u.Z)({method:"GET",params:(0,u.Z)({},n)},o||{})));case 1:case"end":return t.stop()}},r)})),F.apply(this,arguments)}function Ne(r,n){return d.apply(this,arguments)}function d(){return d=_asyncToGenerator(_regeneratorRuntime().mark(function r(n,o){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/v1/node-properties",_objectSpread({method:"GET",params:_objectSpread({},n)},o||{})));case 1:case"end":return t.stop()}},r)})),d.apply(this,arguments)}function ue(r){return D.apply(this,arguments)}function D(){return D=(0,x.Z)((0,i.Z)().mark(function r(n){return(0,i.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,y.WY)("/api/v1/node-types",(0,u.Z)({method:"GET"},n||{})));case 1:case"end":return s.stop()}},r)})),D.apply(this,arguments)}function ce(r,n){return e.apply(this,arguments)}function e(){return e=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/nodes",(0,u.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:n},o||{})));case 1:case"end":return t.stop()}},r)})),e.apply(this,arguments)}function M(r){return B.apply(this,arguments)}function B(){return B=_asyncToGenerator(_regeneratorRuntime().mark(function r(n){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",request("/api/v1/relationship-types",_objectSpread({method:"GET"},n||{})));case 1:case"end":return s.stop()}},r)})),B.apply(this,arguments)}function de(r,n){return V.apply(this,arguments)}function V(){return V=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/relationships",(0,u.Z)({method:"GET",params:(0,u.Z)({},n)},o||{})));case 1:case"end":return t.stop()}},r)})),V.apply(this,arguments)}function xe(r,n){return U.apply(this,arguments)}function U(){return U=(0,x.Z)((0,i.Z)().mark(function r(n,o){return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,y.WY)("/api/v1/similarity",(0,u.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:n},o||{})));case 1:case"end":return t.stop()}},r)})),U.apply(this,arguments)}function Se(r){return J.apply(this,arguments)}function J(){return J=(0,x.Z)((0,i.Z)().mark(function r(n){return(0,i.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,y.WY)("/api/v1/statistics",(0,u.Z)({method:"GET"},n||{})));case 1:case"end":return s.stop()}},r)})),J.apply(this,arguments)}}}]);
